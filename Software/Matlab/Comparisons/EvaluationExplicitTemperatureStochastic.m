% Explicit Temperature Evaluation Stochastic Simulation

afWallsArea							=	[30.08,28.8,30.08,28.8,84.6,84.6];
A									=	tBenchMarkTemperatureController.tModel.aafA;
B									=	tBenchMarkTemperatureController.tModel.aafB;
C									=	tBenchMarkTemperatureController.tModel.aafC;
E									=	tBenchMarkTemperatureController.tModel.aafE;
fTotalArea							=	sum(afWallsArea);
fAverageWallsTemperature			=		1/fTotalArea					...
											*	afWallsArea					...
											* [	fTemperatureInitialCondition(3);		...
												fTemperatureInitialCondition(5);		...
												fTemperatureInitialCondition(7);		...
												fTemperatureInitialCondition(9);		...
												fTemperatureInitialCondition(11);		...
												fTemperatureInitialCondition(13)];
%
x0									=	[	fTemperatureInitialCondition(1) ; 
											fAverageWallsTemperature];
										

tExplicitTemperatureController.tSimulation.aafStatesMatrix											...	
	= zeros(	13,																					...
				tExplicitTemperatureController.iPredictionHorizon + 1);
tExplicitTemperatureController.tSimulation.afInputsMatrix											...
	= zeros(	5,																					...
				tExplicitTemperatureController.iPredictionHorizon);
tExplicitTemperatureController.tSimulation.aafStatesMatrix(:,1)										... 
	= fTemperatureInitialCondition;

 cd Comparisons\Temperature\

[Inputs, iRegion]													=	OriginalPWAfunctionStochastic4000(x0);
 cd ..\..
tExplicitTemperatureController.tSimulation.afInputsMatrix(:,1)		=	Inputs;

for k =  1:tExplicitTemperatureController.iPredictionHorizon
	%
	%
	tExplicitTemperatureController.tSimulation.aafStatesMatrix(:,k+1)		=				...
				A	* tExplicitTemperatureController.tSimulation.aafStatesMatrix(:,k)		...
			+	E	* afDisturbancesScenarioMatrix((k-1)*7+1:k*7)																...
			+	B	* tExplicitTemperatureController.tSimulation.afInputsMatrix(:,k) ;
	%
	fAverageWallsTemperature			=		1/fTotalArea						...
											*	afWallsArea							...
											* [	tExplicitTemperatureController.tSimulation.aafStatesMatrix(3,k+1);		...
												tExplicitTemperatureController.tSimulation.aafStatesMatrix(5,k+1);		...
												tExplicitTemperatureController.tSimulation.aafStatesMatrix(7,k+1);		...
												tExplicitTemperatureController.tSimulation.aafStatesMatrix(9,k+1);		...
												tExplicitTemperatureController.tSimulation.aafStatesMatrix(11,k+1);		...
												tExplicitTemperatureController.tSimulation.aafStatesMatrix(13,k+1)];
	%
	afTwoStatesVector					=	[	tExplicitTemperatureController.tSimulation.aafStatesMatrix(1,k+1) + 0.35;		...
												fAverageWallsTemperature];
	 cd Comparisons\Temperature\
	[afInputs, iRegion]				=	OriginalPWAfunctionStochastic4000(afTwoStatesVector);
	 cd ..\..
	%
	tExplicitTemperatureController.tSimulation.afInputsMatrix(:,k+1)	=	afInputs;
	%
end;%
%
tExplicitTemperatureController.tSimulation.afOutputVector =				...
		tBenchMarkTemperatureController.tModel.aafC						...
	*	tExplicitTemperatureController.tSimulation.aafStatesMatrix;