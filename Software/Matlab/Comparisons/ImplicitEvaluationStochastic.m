%% Implicit Evaluation

tImplicitTemperatureController.tSimulation.afCurrentState					= fTemperatureInitialCondition;
tImplicitTemperatureController.tModel.aafDisturbancesScenarioMatrix			= aafDisturbancesScenarioMatrix;
tImplicitTemperatureController.afLowerBoundForTheVentilation				= repmat(0.1001, 24,1);



tImplicitTemperatureController.tSimulation.StatesMatrixImplicit							...	
			= zeros(	13,																...
						tImplicitTemperatureController.iPredictionHorizon + 1);
tImplicitTemperatureController.tSimulation.afInputsMatrix								...
			= zeros(	5,																...
						tImplicitTemperatureController.iPredictionHorizon);
tImplicitTemperatureController.tSimulation.aafStatesMatrix(:,1)							... 
			= tImplicitTemperatureController.tSimulation.afCurrentState;
cd ..

for iTimeStep = 1:tImplicitTemperatureController.iPredictionHorizon
	%
	tImplicitTemperatureController.ComputeControlInputs();
	%
	tImplicitTemperatureController.tSimulation.afInputsMatrix(:,iTimeStep)					...
			= [		tImplicitTemperatureController.afOptimizationProblemSolution(1);		...
					tImplicitTemperatureController.afOptimizationProblemSolution(2);		...
					tImplicitTemperatureController.afOptimizationProblemSolution(3);		...
					tImplicitTemperatureController.afOptimizationProblemSolution(4);		...
					tImplicitTemperatureController.afOptimizationProblemSolution(5); 		...
				];
	%
	SimulationImplicitTemperature
	%
	tImplicitTemperatureController.tSimulation.afCurrentState						...
		= tImplicitTemperatureController.tSimulation.aafStatesMatrix(:,iTimeStep );
end;%
