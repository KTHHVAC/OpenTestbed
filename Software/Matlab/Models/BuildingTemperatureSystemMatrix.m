%clc
%Input parameters

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Building model by Marco Molinari
% Ver. 1.0
% 
% Description:
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % General parameters 
rho_air=1.2;            % Air density, [kg/m^3] 
cpa=1006;               % Air specific heat, [J/kgK]
hi=7.7;                 % Indoor heat transfer coefficient (walls - room),[J/m^2K]
ho=25;                  % Outdoor heat transfer coefficient (outdoor environment - walls),[J/m^2K]
a=0.7;                  % Wall1 absorptance, [-]
alpha_e=25;             % Wall 1 heat transfer coefficient,[J/m^2K]
    % Room dimensions
W1=9.4;
W2=9;
H=3.2;
Aw1= 30.08-2.56;        % Wall 1 area, [m2]
Aw2= 28.8;              % Wall 2 area, [m2]
Aw3= 30.08;             % Wall 3 area, [m2]
Aw4= 28.8;              % Wall 4 area, [m2]
Aw5 = 84.6;             % Wall 5 (ceiling) area, [m2]
Aw6 = 84.6;             % Wall 6 (floor), [m2]
    % Room thermo-physical parameters
        % Walls
Uw1=0.3525;             % Wall 1 resistance, [K/W]
Uw2=2.467;              % Wall 2 resistance, [K/W]
Uw3=2.467;              % Wall 3 resistance, [K/W]
Uw4=2.467;              % Wall 4 resistance, [K/W]
Uw5=3.872;              % Wall 5 (ceiling) resistance, [K/W]
Uw6=3.872;              % Wall 6 (floor) resistance, [K/W]
Cw1=5779200/2;          % Wall 1 heat capacity, [J/K]
Cw2=23316480/2;         % Wall 2 heat capacity, [J/K]
Cw3=23316480/2;         % Wall 3 heat capacity, [J/K]
Cw4=24352768/2;         % Wall 4 heat capacity, [J/K]
Cw5=25684560/2;         % Wall 5 (ceiling) heat capacity, [J/K]
Cw6=25684560/2;         % Wall 6 (floor) heat capacity, [J/K]
        % Windows
Gwin1=0.7;              % Window 1 G-value (SHGC), [-]
Uwin1=1.9;              % Window 1 transmittance, [W/m2K]
Awin1=2.56;             % Window 1 area, [m2]
Rwin1=1/(Uwin1*Awin1);  % Total window thermal resistance, [K/m2]
    % Emission parameters (for [B])
A_rad=50;               % Radiator emission surface, [m2]
h_rad=8;               % Radiator heat transfer coefficient, [W/m2K]        
    % Occupancy parameters
q_pers=70;              % Sensible heat emitted per person, [W/pers]
q_equip=100;            % Sensible heat emitted by equipment per person, [W/pers]
% Parameters processing
V_room=W1*W2*H;
m_air=V_room*rho_air;
q_occ=q_pers+q_equip;

 Rw1=1/(Aw1*Uw1);        % Wall 1 thermal resistance, [K/W]
 Rw2=1/(Aw2*Uw2);        % Wall 2 thermal resistance, [K/W]
 Rw3=1/(Aw3*Uw3);        % Wall 3 thermal resistance, [K/W]
 Rw4=1/(Aw4*Uw4);        % Wall 4 thermal resistance, [K/W]
 Rw5=1/(Aw5*Uw5);        % Wall 5 (ceiling) thermal resistance, [K/W]
 Rw6=1/(Aw6*Uw6);        % Wall 6 (floor) thermal resistance, [K/W]

% [A][x]
%               1   2   3    4    5    6     7    8    9    10   11  12  13
% x=transpose([Tr,T1wo,T1wi,T2wo,T2wi,T3wo,T3wi,T4wo,T4wi,T5wo,T5wi,T6wo,T6wi])
A = zeros(13);
% Room node
%A(1,1)= -(A_rad*h_rad)/(m_air*cpa)-hi*(Aw1+Aw2+Aw3+Aw4+Aw5+Aw6)/(m_air*cpa)-1/(Rwin1*(m_air*cpa));
A(1,1)= -hi*(Aw1+Aw2+Aw3+Aw4+Aw5+Aw6)/(m_air*cpa)-1/(Rwin1*(m_air*cpa));
A(1,3)= hi*Aw1/(m_air*cpa);
A(1,5)= hi*Aw2/(m_air*cpa);
A(1,7)= hi*Aw3/(m_air*cpa);
A(1,9)= hi*Aw4/(m_air*cpa);
A(1,11)= hi*Aw5/(m_air*cpa);
A(1,13)= hi*Aw6/(m_air*cpa);
% Wall 1
    % Outdoor wall surface
A(2,2)=(-ho*Aw1)/Cw1-(1/(Rw1*Cw1));
A(2,3)= 1/(Rw1*Cw1);
    % Indoor wall surface
A(3,1)=(hi*Aw1)/Cw1;
A(3,2)=1/(Rw1*Cw1);
A(3,3)=(-hi*Aw1)/Cw1-(1/(Rw1*Cw1));
% Wall 2
    % Outdoor wall surface
A(4,4)=-(1/(Rw2*Cw2));
A(4,5)= 1/(Rw2*Cw2);
    % Indoor wall surface
A(5,1)=(hi*Aw2)/Cw2;
A(5,4)=1/(Rw2*Cw2);
A(5,5)=(-hi*Aw2)/Cw2-(1/(Rw2*Cw2));
% Wall 3
    % Outdoor wall surface
A(6,6)=-(1/(Rw3*Cw3));
A(6,7)= 1/(Rw3*Cw3);
    % Indoor wall surface
A(7,1)=(hi*Aw3)/Cw3;
A(7,6)=1/(Rw3*Cw3);
A(7,7)=(-hi*Aw3)/Cw3-(1/(Rw3*Cw3));
% Wall 4
    % Outdoor wall surface
A(8,8)=-(1/(Rw4*Cw4));
A(8,9)= 1/(Rw4*Cw4);
    % Indoor wall surface
A(9,1)=(hi*Aw4)/Cw4;
A(9,8)=1/(Rw4*Cw4);
A(9,9)=(-hi*Aw4)/Cw4-(1/(Rw4*Cw4));
% Wall 5 (ceiling)
    % Outdoor wall surface
A(10,10)=-(1/(Rw5*Cw5));
A(10,11)= 1/(Rw5*Cw5);
    % Indoor wall surface
A(11,1)=(hi*Aw5)/Cw5;
A(11,10)=1/(Rw5*Cw5);
A(11,11)=(-hi*Aw5)/Cw5-(1/(Rw5*Cw5));
% Wall 6 (floor)
    % Outdoor wall surface
A(12,12)=-(1/(Rw6*Cw6));
A(12,13)= 1/(Rw6*Cw6);
    % Indoor wall surface
A(13,1)=(hi*Aw6)/Cw6;
A(13,12)=1/(Rw6*Cw6);
A(13,13)=(-hi*Aw6)/Cw6-(1/(Rw6*Cw6));

% [B][u]
% [u]=transpose([mvent*Tsa,mvent*Troom,Tmr])
B = zeros(13,3);
% Room node
B(1,1)= 1/m_air;
B(1,2)= -1/m_air;
B(1,3)= (A_rad*h_rad)/(m_air*cpa);

% [E][w]
%[w]=transpose([Tamb,I1,Npeople])
E=zeros(13,3);
% Room node
E(1,1)= 1/(Rwin1*m_air*cpa); 
E(1,2)= Gwin1*Awin1/(m_air*cpa);
E(1,3)= q_occ/(m_air*cpa);
% Wall 1
    % Outdoor wall surface
E(2,1)= ho*Aw1/Cw1;
E(2,2)=(ho*Aw1*a/alpha_e)/Cw1;

% A
% 
% B
% 
% E


Ac_room = A; % Dynamic matrix
Bc_room = B; % Input matrix
Ec_room = E; % Disturbance matrix