% algorithm
%
% - extract the scenarios on the sky covers
% - compute the maximal radiation profile starting from the current julian date
% - convert the scenarios on the cloud covers into scenarios on the solar radiation
%
function aafScenarios =				...
			ExtractScenarios(		...
				tGenerator,			...
				fInitialJulianDate,	...
				iNumberOfScenarios,	...
				fInitialCondition	)
	%
	try %
		%
		% extract the sky cover scenarios
		if( nargin == 3 )
			%
			aafScenariosOnSkyCover =										...
				tGenerator.ExtractScenarios@Scenarios.ScenariosGenerator(	...
					fInitialJulianDate,										...
					iNumberOfScenarios										);
			%
		else%
			%
			aafScenariosOnSkyCover =										...
				tGenerator.ExtractScenarios@Scenarios.ScenariosGenerator(	...
					fInitialJulianDate,										...
					iNumberOfScenarios,										...
					fInitialCondition										);
			%
		end;%
		%
		% find the julian dates
		afJulianDates =												...
			(														...
					( 1:tGenerator.iForecastingHorizonInSamples )	...
				*	tGenerator.fSamplingTimeInSeconds				...
				*	Time.GetJulianSecond()							...
			)														...
			+														...
			fInitialJulianDate;
		%
		% find the maximal radiation profiles
		tMaximalRadiationSignal		= tGenerator.tSkyCoverToRadiationConverter.GetMaximalRadiationSignal( afJulianDates );
		afMaximalRadiationSamples	= tMaximalRadiationSignal.ExtractSamplesAt( afJulianDates );
		%
		% storage allocation
		aafScenarios = zeros( size(aafScenariosOnSkyCover) );
		%
		% convert the sky cover scenarios into radiation scenarios -- remember that the scenarios are by row
		for iScenario = 1:size( aafScenarios, 1 )
			%
			aafScenarios( iScenario, : ) =							...
				tGenerator.tSkyCoverToRadiationConverter.Convert(	...
					( aafScenariosOnSkyCover( iScenario, : )' ),	...
					afMaximalRadiationSamples						);
			%
		end;% cycle on the scenarios	
		%
	catch exception
		%
		disp( exception.message );
		warning('Unable to extract the Scenarios');
		%
	end % try
	%
end % function

