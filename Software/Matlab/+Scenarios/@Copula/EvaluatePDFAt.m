% assumption: each sample is a row vector
%
function afEvaluations = EvaluatePDFAt( tCopula, aafSamples )
	%
	% for readability
	iNumberOfSamples = numel( aafSamples(:, 1) );
	%
	% storage allocation
	afEvaluations = zeros( iNumberOfSamples, 1 );
	%
	% sanity check: the number of elements of each sample must be equal
	% to the size of the copula matrix
	if( numel(tCopula.aafCopula(:, 1)) ~= numel( aafSamples(1, :) ) )
		%
		error('the number of elements in the sample is incompatible with the learned copula');
		%
	end;%
	%
	% rank the samples
	aafRankedSamples = tCopula.RankSamples( aafSamples );
	%
	% cycle on the various samples
	for iSample = 1:iNumberOfSamples;
		%
		% evaluate
		switch( tCopula.strCopulaFamily )
			%
			case 'Gaussian'
				afEvaluations(iSample) = 						...
					copulapdf(	tCopula.strCopulaFamily,		...
								aafRankedSamples(iSample, :),	...
								tCopula.aafCopula				);
			%
			otherwise
				error('wrong copula type');
			%
		end;% switch on the copula type
		%
	end;% cycle on the various samples
	%
end % function
