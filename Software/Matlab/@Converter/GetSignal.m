%
% function tSignal = GetSignal( tDataset, iSignalID, iDeviceID )
%
% Extract a specific signal from a dataset.
%
% It is convenient to look for the right iSignalID and iDeviceID
% by loading the corresponding structures, i.e., by executing
%
% tSignalsIDs = Signal.GetSignalsIDs()
% tDevicesIDs = Signal.GetDevicesIDs()
%
% The returned objects is a Signal() object, see the corresponding
% class for its capabilities
%
function tSignal = GetSignal( tDataset, iSignalID, iDeviceID )
	%
	% initialization
	tSignal = [];
	%
	for iSignal = 1:numel( tDataset.aiSignalsIDs )
		%
		if(		tDataset.aiDevicesIDs(iSignal) == iDeviceID	...
			&&	tDataset.aiSignalsIDs(iSignal) == iSignalID	)
			%
			tSignal = Signal();
			%
			tSignal.iSignalID	= tDataset.aiSignalsIDs(iSignal);
			tSignal.iDeviceID	= tDataset.aiDevicesIDs(iSignal);
			%
			tSignal.afTimes			= tDataset.afSignalsTimes;
			tSignal.afValues		= tDataset.aafSignalsValues(:, iSignal);
			tSignal.afInaccuracies	= tDataset.aafSignalsInaccuracies(:, iSignal);
			%
			% put the signals as columns
			tSignal.afValues =									...
				reshape(	tSignal.afValues,					...
							numel( tSignal.afValues ), 1		);
			tSignal.afTimes =									...
				reshape(	tSignal.afTimes,					...
							numel( tSignal.afTimes ), 1			);
			tSignal.afInaccuracies =							...
				reshape(	tSignal.afInaccuracies,				...
							numel( tSignal.afInaccuracies ), 1	);
			%
			tSignal.afX			= tDataset.aafSignalsPositions(1, iSignal);
			tSignal.afY			= tDataset.aafSignalsPositions(2, iSignal);
			tSignal.afZ			= tDataset.aafSignalsPositions(3, iSignal);
			%
			tSignal.SetInvalidDataMarker();
			tSignal.strDescription = Signal.GetDescription(				...
													tSignal.iSignalID,	...
													tSignal.iDeviceID	);
			%
			% assumption: the device gives only one signal with that ID
			return;
			%
		end;%
		%
	end;%
	%
	% if here it means that we found nothing
	fprintf('%f / %f \n', iSignalID, iDeviceID);
	warning('I did not find the desired signal ID / device ID in the current dataset. Returning an empty object\n');
	%
end %

