% ASSUMPTION: THE OCCUPANCY IS THE FIRST INPUT
%
function Estimate(								...
			tEstimator,							...
			tAirInletValveOpeningSignal,		...
			tAirInletTemperatureSignal,			...
			tAirInletCO2Signal,					...
			tRoomCO2Signal,						...
			tRoomTemperatureSignal,				...
			fCurrentJulianDate					) % NOT NECESSARY -- this input may be used to force the estimator
	%
	if( nargin == 4 )
		%
		% if not passed, then get the current julian date
		fCurrentJulianDate = Time.GetCurrentJulianDate();
		%
	end;%
	%
	% ...from which understand where to sample the signals
	afJulianDates =												...
			fCurrentJulianDate									...	
		-	(													...	
					( 0:tEstimator.iWindowsLengthInSamples-1 )	...	
	   			*	tEstimator.fSamplingTimeInSeconds			...	
				/	Time.GetJulianSecond()						...	
			);
	%
	% compute then the matrices for the batch estimate
	[	aafInputs,									...
		afOutput 	] =								...
			tEstimator.TransformSignals(			...
				tAirInletValveOpeningSignal,		...
				tAirInletTemperatureSignal,			...
				tAirInletCO2Signal,					...
				tRoomCO2Signal,						...
				tRoomTemperatureSignal,				...
				[],									...
				afJulianDates						);
	%
	% compute the estimate over the whole orizon
	afEstimatedOccupancy = tEstimator.EstimateBatch( aafInputs, afOutput );
	%
	% insert the last sample in the corresponding signal
	tEstimator.tEstimatedOccupancySignal.Insert(	...
		afEstimatedOccupancy(end),					...
		fCurrentJulianDate							);
	%
	%
	%
	% DEBUG
% 	Time.JulianDateToString( afJulianDates )
	%
end % function

