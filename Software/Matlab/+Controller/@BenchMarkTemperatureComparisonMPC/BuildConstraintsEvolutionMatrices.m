%  Function BuildConstraintsEvolutionMatrices( tController )
%  Prepare constraints matrices over the prediction horizon for Implicit MPC.
%  For more info about notation look at the guide
%
function BuildConstraintsEvolutionMatrices( tController )
	%
	try %
		%-----------------------------------------------------------------------------
		% build the constraint matrices over the whole horizon
		tController.tModel.aafGGu		= VariantKron( tController.tModel.aaafGu );
		tController.tModel.aafGGy		= VariantKron( tController.tModel.aaafGy );
		tController.tModel.aafGGe		= VariantKron( tController.tModel.aaafGe );
		tController.tModel.aafGGuMixed	= VariantKron( tController.tModel.aaafGuMixed );
		tController.tModel.aafGGeMixed	= VariantKron( tController.tModel.aaafGeMixed );
		%
		tController.tModel.afBBu		= VariantRepMat( tController.tModel.aaafBu );
		tController.tModel.afBBy		= VariantRepMat( tController.tModel.aaafBy );
		tController.tModel.afBBMixed	= VariantRepMat( tController.tModel.aaafBMixed );
		%
		[	tController.tModel.aafGGxMixed,					...
			tController.tModel.aafBBx0Mixed]				...
				=	VariantSubDiagonalAndVector( tController.tModel.aaafGxMixed ) ; 
		%
		%------------------------------------------------------------------------------
	catch exception
		%
		disp(exception.message)
		warning('Problems building the constraints evolution matrices')
		%
	end;% end catch
	%
end % end function
