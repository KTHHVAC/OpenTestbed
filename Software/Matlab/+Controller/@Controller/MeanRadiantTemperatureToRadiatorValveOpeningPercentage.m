% function fRadiatorValveOpeningPercentage									...
% 				= MeanRadiantTemperatureToRadiatorValveOpeningPercentage(	...
% 						fMeanRadiantTemperature,							...
% 						fRoomTemperature,									...
% 						fOutsideTemperature								)
%
function fRadiatorValveOpeningPercentage									...
				= MeanRadiantTemperatureToRadiatorValveOpeningPercentage(	...
						fMeanRadiantTemperature,							...
						fRoomTemperature,									...
						fOutsideTemperature								)
	%
	%
	try %
		%
		if ( fMeanRadiantTemperature < fRoomTemperature )
			%
			warning('Warming requested but the mean radiant temperature requested is lower of the room temperature. There might be an error.');
			fRadiatorValveOpeningPercentage = 0;
			%
			% end check on the ideality of the solution
			%
		else% 
			%
			%
			EFFICIENCY = 0.85; % TODO:Check this stuff!!!!!!
			%
			fWaterTemperature = Controller.Controller.OutsideTemperatureToRadiatorWaterTemperature( fOutsideTemperature );
			fEffectiveWaterTemperature = fWaterTemperature * EFFICIENCY;
			%
			fRadiatorValveOpeningPercentage =		( fMeanRadiantTemperature - fRoomTemperature )		...
												/	( fEffectiveWaterTemperature - fRoomTemperature )	...
												*	100;
			%
			if ( fRadiatorValveOpeningPercentage < 50 )
				%
				fRadiatorValveOpeningPercentage = fRadiatorValveOpeningPercentage + 5;
				%
			end;%
			%
			if ( fRadiatorValveOpeningPercentage == 5 )  % i.e. no radiator warming is requested
				%
				fRadiatorValveOpeningPercentage = 0;
				%
			end;%
			%
			%
			fRadiatorValveOpeningPercentage = round( 10.* ( fRadiatorValveOpeningPercentage ) )/10;
			%
			if	( fRadiatorValveOpeningPercentage > 100 )
				%
				fRadiatorValveOpeningPercentage = 100;
				%
			elseif ( fRadiatorValveOpeningPercentage < 0 )
				%
				fRadiatorValveOpeningPercentage = 0;
				%
			end;%
			%
		end;% end of the percentage computation
		%
		%
	catch exception
		%
		disp(exception.message);
		warning('Problems calculating the opening percentage for the radiators.');
		%
	end;% end catch
	%
end % end function

