% function DiscretizeModel( tController )
% 
function DiscretizeModel( tController )
	% Prepare discrete system matrices. Forward Eulero
	%
	try
		BB = [tController.tModel.aafB tController.tModel.aafE];
		
		dT = tController.fSamplingTimeInSeconds; 		% check the Configuration file: 3600 * obj.fSamplingTimeInSeconds
												% only if the sampling time is given as fractions of hour! So, it
												% should not be in seconds; in this case, drop 3600
        sys  = ss( tController.tModel.aafA, BB, tController.tModel.aafC, 0 );
        sysd = c2d( sys, dT );
        [A, Bd, C, D] = ssdata( sysd );
		
% 		% BACKWARD EULER
% 		%	Get discretized system
% 		A =(eye(obj.tModel.iNx) - dT*obj.tModel.aafA)^(-1);
% 		Bd = A*BB*dT;
% 		C = obj.tModel.aafC*A;
%       Dd = C*A*BB*dT;
%       Ed = Dd( :, obj.tModel.iNu+1 : end );
% 		D  = Dd( :, 1 : obj.tModel.iNu );

		E = Bd( :, tController.tModel.iNu+1 : end );
		B = Bd( :, 1 : tController.tModel.iNu );

		tController.tModel.aafA = A;
		tController.tModel.aafB = B;
		tController.tModel.aafE = E;
		tController.tModel.aafC = C;

	catch exception
		tController.AddError( strcat('MPController.ModelDiscretize: ', exception.message ));
	end
end

%===============================================================================