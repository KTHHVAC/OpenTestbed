% function SetInitialConditions( tController )
% 
function SetInitialConditions( tController )
	% get the initial condition for the optimization problem from the server. 
	% In thiss simple version these are set to see if the optimization
	% problem is solved correctly.
	%
	try %
		%
		fCurrentJulianDate					= Time.GetCurrentJulianDate();
		%
		%------------------------------------------------------------------
		%retriving the needed indexes
		iTemperatureOfTheRoomIndex		=	tController.tMeasurementsSignalsIndexes.iRoomTemperature;
		iTemperatureWall_1_OutIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall1Out;
		iTemperatureWall_1_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall1In;
		iTemperatureWall_2_OutIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall2Out;	
		iTemperatureWall_2_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall2In;
		iTemperatureWall_3_OutIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall3Out;
		iTemperatureWall_3_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall3In;
		iTemperatureWall_4_OutIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall4Out;
		iTemperatureWall_4_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfWall4In;
		iTemperatureFloor_OutIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfFloorOut;
		iTemperatureFloor_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfFloorIn;
		iTemperatureCeiling_OutIndex	=	tController.tMeasurementsSignalsIndexes.iTemperatureOfCeilingOut;
		iTemperatureCeiling_InIndex		=	tController.tMeasurementsSignalsIndexes.iTemperatureOfCeilingIn;
		%
		%
		%------------------------------------------------------------------
		% retriving the measurements i need
		% 
		fTemperatureOfTheRoom	= tController.atMeasurementsSignals(iTemperatureOfTheRoomIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureWall_1_Out	= tController.atMeasurementsSignals(iTemperatureWall_1_OutIndex).ExtractSamplesAt(fCurrentJulianDate);		
		fTemperatureWall_1_In	= tController.atMeasurementsSignals(iTemperatureWall_1_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureWall_2_Out	= tController.atMeasurementsSignals(iTemperatureWall_2_OutIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureWall_2_In	= tController.atMeasurementsSignals(iTemperatureWall_2_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureWall_3_Out	= tController.atMeasurementsSignals(iTemperatureWall_3_OutIndex).ExtractSamplesAt(fCurrentJulianDate);			
		fTemperatureWall_3_In	= tController.atMeasurementsSignals(iTemperatureWall_3_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureWall_4_Out	= tController.atMeasurementsSignals(iTemperatureWall_4_OutIndex).ExtractSamplesAt(fCurrentJulianDate);			
		fTemperatureWall_4_In	= tController.atMeasurementsSignals(iTemperatureWall_4_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureFloor_Out	= tController.atMeasurementsSignals(iTemperatureFloor_OutIndex).ExtractSamplesAt(fCurrentJulianDate);	
		fTemperatureFloor_In	= tController.atMeasurementsSignals(iTemperatureFloor_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureCeiling_Out = tController.atMeasurementsSignals(iTemperatureCeiling_OutIndex).ExtractSamplesAt(fCurrentJulianDate);
		fTemperatureCeiling_In	= tController.atMeasurementsSignals(iTemperatureCeiling_InIndex).ExtractSamplesAt(fCurrentJulianDate);
		%
		afInitialConditions	= [		fTemperatureOfTheRoom	;
									fTemperatureWall_1_Out	;
									fTemperatureWall_1_In	;
									fTemperatureWall_2_Out	;
									fTemperatureWall_2_In	;
									fTemperatureWall_3_Out	;
									fTemperatureWall_3_In	;
									fTemperatureWall_4_Out	;
									fTemperatureWall_4_In	;
									fTemperatureFloor_Out	;
									fTemperatureFloor_In	;
									fTemperatureCeiling_Out ;
									fTemperatureCeiling_In		];
		%
		tController.tModel.afX0 = afInitialConditions;
		%
	catch exception
		%
		disp(exception.message);
		warning('Problems setting the initial conditions of the optimization problem');
		%
	end;% end catch
	%
end %