% 
% function InsertAsPiecewiseConstant( tSignal, fValue, fTime )
% 
% insert 2 values: one at the specified time, that MUST be greater than the 
% last one inserted, and one immediately before (1 second) so that the
% corresponding signal will be piecewise constant
%
function InsertAsPiecewiseConstant( tSignal, fValue, fTime )
	%
	if( numel( tSignal.afTimes ) == 0 )
		%
		% case the signal starts now, do nothing special
		tSignal.afTimes(1)			= fTime;
		tSignal.afValues(1)			= fValue;
		tSignal.afInaccuracies(1)	= 0;
		%
	else%
		%
		% check if the current time is not greater than the last one
		if( fTime <= tSignal.afTimes(end) - 0.1 * Time.GetJulianSecond() )
			%
			error('Cannot insert a sample in a piecewise constant signal. Times between samples are inconsistent');
			%
		else%
			%
			% we can insert the sample. Thus insert the sample before and then the new one
			tSignal.Insert( tSignal.afValues(end), fTime - Time.GetJulianSecond() );
			tSignal.Insert( fValue, fTime );
			%
		end;%
		%
	end;% if there are samples in the signal
	%
	% DEBUG
% 	disp( tSignal.afValues )
% 	Time.JulianDateToString( tSignal.afTimes )
	%
end % function

