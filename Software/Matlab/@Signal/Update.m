% function Update( tSignal, tTCPConnection )
% it updates the values of the chosen signals from the set source
%
function Update( tSignal, tTCPConnection )
	%
	try %
		%
		iSourceForUpdate = tSignal.ChooseSourceForUpdate();
		%
		switch iSourceForUpdate
			%
			case 1 % From the server
				%
				[ afValues, afTimes ] = tTCPConnection.GetFromServer( tSignal.iSignalID, tSignal.iDeviceID );
				%
			case 2 % From a mat file
				%
				[ afValues, afTimes ] = tSignal.GetForecastFromMatFile();
				%
			case 3 % From a lookup table or a txt file
				%
				[ afValues, afTimes ] = tSignal.GetFromTxtFileOrLookUpTable();
				%
			case 4 % Sinusoidal forecast that depends on the current value and the time of the day
				%
				[ afValues, afTimes ] = tSignal.GetSinusoidalForecasts( tTCPConnection );
				%
			otherwise
				%
				error('Error occurred: the chosen update source does not exist');
				%
		end		%
		%
		%
		if( numel( afValues ) > 0 )
			%
			tSignal.Insert( afValues, afTimes, true ); % the true says "overwrite old samples with the very same julian date"
			%
		else%
			%
			warning('Signal %d - %d (%s) did not update its values', tSignal.iSignalID, tSignal.iDeviceID, tSignal.strDescription );
			%
		end;%
		%
	catch exception
		%
		disp(exception.message)
		warning('Unable to update the signal')
		%
	end;% end catch
	%
end % function
