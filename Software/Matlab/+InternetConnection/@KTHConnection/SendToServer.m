function SendToServer( tConnection, iSignalID, iDeviceID, strLocation, fValue )
	%
	try %
		%
		strHeader = tConnection.GetSendMessageHeader(iSignalID, iDeviceID, strLocation);
		%
		% Create the data request message
		tConnection.tMessage.acData = sprintf(	'%s\r%d\r%s\r%0.2f',	...
												strHeader,				...
												iSignalID,				...
												strLocation,			...
												fValue 					);
		%
		tConnection.tMessage.iSize = size( tConnection.tMessage.acData, 2 );
		%
		% Send the request
		tConnection.SendData( );
		%
		% Receive the answer
		tConnection.ReceiveData( );
		%
		% if the received data is successful then exit
		if( strcmp( tConnection.strError, 'Success' ) ~= 1 )
			%
			return;
			%
		end;%	
		%
		% otherwise check if we got incomplete data
		if( strcmp( char( tConnection.tMessage.acData{1, 2} ), 'EndOfTx' ) ~= 1 )
			%
			tConnection.strError = 'tConnection.SetDataPLC: Incomplete data';
			return;
		end
		%
		achOKMsg = sprintf('OK! \nActuation is done successfully.');
		if( strcmp( char( tConnection.tMessage.acData{1, 1} ), achOKMsg ) ~= 1 )
			%
			tConnection.strError = 'tConnection.SetDataPLC: Actuation unsuccessful';
			return;
			%
		end;%
		%
	catch exception
		%
		%DEBUG
		disp(exception.message);
		tConnection.strError = strcat( 'tConnection.SetDataPLC: ', exception.message );
		%
	end;%
	%
end % function

