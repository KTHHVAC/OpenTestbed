function ConnectToHVAC( tConnection )
	%
	try %
		%
		fprintf('Trying to connect to the server...');
		%
		% 1. Create the access request message
		index = 1;
		aiDigestArray = zeros(1, 64);
		for i = 1 : 64
			% Change digest representation from 128 digits, 4 bits each
			% to 64 bytes
			aiDigestArray(i) = hex2dec( strcat( tConnection.achDigest( index ), tConnection.achDigest( index + 1 )));
			index = index + 2;
		end
		%
		tConnection.tMessage.acData = sprintf( 'SendUsernamePass\r%s\r%s',	...
												 tConnection.strUser,		...
												 aiDigestArray );
		tConnection.tMessage.iSize = size( tConnection.tMessage.acData, 2 );
		%
		% 2. Send the request
		tConnection.SendData();
		%
		% 3. Receive the answer
		tConnection.ReceiveData();
		%
		% 4. Check the answer 
		if( strcmp( tConnection.strError, 'Success' ) == 0 )
			%
			fprintf('...connected!\n');
			%
		elseif( strcmp( char( tConnection.tMessage.acData{1, 2} ), 'EndOfTx' ) ~= 1 )
			%
			tConnection.strError = 'tConnection.ConnectToHVAC: Incomplete data';
			fprintf('...NOT CONNECTED: received an incomplete data packet!\n');
			%
		elseif( strcmp( char( tConnection.tMessage.acData{1, 1} ), 'Access Granted!' ) ~= 1 )
			%
			tConnection.strError = 'tConnection.ConnectToHVAC: Access denied';
			fprintf('...NOT CONNECTED: the server denied the access!\n');
			%
		else%
			%
			disp(tConnection.strError)
			%
		end;%
		%
	catch exception
		%
		tConnection.strError = strcat( 'tConnection.ConnectToHVAC: ', exception.message );
		disp(exception.message)
		warning('Unable to connect to the HVAC server');
		%
	end;%
	%
end % function

