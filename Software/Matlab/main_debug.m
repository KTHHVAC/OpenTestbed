% locked out from the system
if( any( strcmp( who, 'tTCPConnection' ) ) )
	%
	fclose( tTCPConnection.tTcpIpClient );
	%
end;%

close all;
clear all;
clear classes;
clc;
 
%Todo
%		- Change the thermal bounds based on the occupancy;

% to get the updated models
addpath(genpath('Models/'));

% to get CPLEX path
addpath(genpath('/Users/giorgiopattarello/Applications/IBM/ILOG/CPLEX_Studio1251/cplex/'))
addpath(genpath('C:/Program Files/IBM/ILOG/CPLEX_Studio125/cplex'));

% import the necessary classes
import Controller.*;
import MatlabToTikZ.*;
import InternetConncetion.*;
import Scenarios.*;

% load the parameters	
[tControllerParametersCO2 , tControllerParametersTemperature] = Controller.LoadBuildSys2013Parameters();  
%
tTCPConnectionParameters 	= InternetConnection.LoadDefaultTCPConnectionParameters();

% allocate the TCP connection and the controller
tTCPConnection 	= InternetConnection.KTHConnection( tTCPConnectionParameters );

tControllerCO2				= Controller.MPControllerLinear(	tControllerParametersCO2 ,			tTCPConnection	);
tControllerTemperature		= Controller.MPControllerLinear(	tControllerParametersTemperature ,	tTCPConnection );


tControllerCO2.OnStart();	
tControllerCO2.Run(tTCPConnection);

%  
% tControllerTemperature.OnStart();
% tControllerTemperature.Run(tTCPConnection);

fclose( tTCPConnection.tTcpIpClient );
