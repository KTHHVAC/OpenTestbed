% 
% function Insert( tSignal, afValues, afXAxis, afYAxis )
% 
% insert some values at specific XY positions 
%
function Insert( tSignal, afValues, afXAxis, afYAxis )
	%
	%
	if( numel( tSignal.afTimes ) == 0 )
		%
		% to prevent guys that give "afTimes" that are not sorted we insert just
		% 1 sample then we recall the function 
		tSignal.afTimes(1)			= afXAxis(1);
		tSignal.afYAxis(1)			= afYAxis(1);
		tSignal.afValues(1)			= afValues(1);
		tSignal.afInaccuracies(1)	= 0;
		%
		tSignal.Insert( afValues(2:end), afTimes(2:end), bOverwriteOldSamples );
		%
		% DEBUG
% 		fprintf('Insert(): number of elements: %d (from number of elements == 0)\n', numel(tSignal.afTimes));
		%
	else%
		%
		for iSample = 1:numel( afTimes )
			%
			if( afTimes(iSample) > tSignal.afTimes(end) )
				%
				tSignal.InsertAtTheEnd( afValues(iSample), afTimes(iSample) );
				%
			else%
				%
				% find the place where to put the sample
				iIndex = find(  tSignal.afTimes > afTimes(iSample), 1, 'first' );
				%
				% check if the time is already in the signal
				if( afTimes(iSample) == tSignal.afTimes(iIndex) )
					%
					% case time is already present => overwrite if desired
					if( bOverwriteOldSamples )
						%
						tSignal.afValues(iIndex, 1) 		= afValues(iSample);
						tSignal.afInaccuracies(iIndex, 1) 	= 0;
						%
						% DEBUG
% 						fprintf('Insert(): number of elements: %d (from overwrite old samples)\n', numel(tSignal.afTimes));
						%
					end;%
					%
					% DEBUG
% 					fprintf('Insert(): number of elements: %d (no elements have been inserted)\n', numel(tSignal.afTimes));
					%
				else%
					%
					%
					% 2) shift the samples from iIndex, one to the right
					tSignal.afValues(iIndex+1:end+1, 1)			= tSignal.afValues(iIndex:end, 1);
					tSignal.afTimes(iIndex+1:end+1, 1)			= tSignal.afTimes(iIndex:end, 1);
					tSignal.afInaccuracies(iIndex+1:end+1, 1)	= tSignal.afInaccuracies(iIndex:end, 1);
					%
					% 3) insert the desired value
					tSignal.afValues(iIndex, 1)			= afValues(iSample);
					tSignal.afTimes(iIndex, 1)			= afTimes(iSample);
					tSignal.afInaccuracies(iIndex, 1)	= 0;
					%
					% DEBUG
% 					fprintf('Insert(): number of elements: %d (from normal case)\n', numel(tSignal.afTimes));
					%
				end;% if time is already in signal
				%
			end;% if the sample is at the end
			%
		end;% cycle on samples
		%
	end;% if there are samples in the signal
	%
	%
end % function

