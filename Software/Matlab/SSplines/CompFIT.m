

function  [W,Wytest,Waltytest]=CompFIT(M,f,Utest,ytest,UtestWN,ytestWN);

nf=length(f);
f1=impulse(M,[0 1:1000]);f1=f1(1:nf);

%%%%%%Fit on future output data generated using WN as future input
datTest=iddata(ytestWN',UtestWN');
predd=predict(M,datTest,1,'z');predd=iddata(predd);Y2=(predd.y)';
W=100*(1-norm(Y2-ytestWN)/norm(ytestWN-mean(ytestWN)));
%f0=mean(f);%set f0=0 to obtain the
%Wden=norm(f);;%Wden=norm(f-f0);
%Wnum=norm(f-f1);
%W=100*(1-Wnum/Wden);

%%%%%%Fit same input%%%%%%%%%%%%%%%%%%%%%
Y=filter(f1,1,Utest);
Wytest=100*(1-norm(Y-ytest)/norm(ytest-mean(ytest)));

%%%%%ALTERNATIVE to Fit same input%%%%%
datTest=iddata(ytest',Utest');
predd=predict(M,datTest,1,'z');predd=iddata(predd);Y2=(predd.y)';
Waltytest=100*(1-norm(Y2-ytest)/norm(ytest-mean(ytest)));