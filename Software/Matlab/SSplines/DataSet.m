

clear all
close all
m=1;%number of system inputs
gen=1;%or 2
Pbound=0.95;
mPEM=30;
nf=100;%length impulse response coefficients
p=nf;%number of predictor coefficients to estimate
N=1000;%300;%training set size
z=[];
SNR=[1 9];
inp=[2 0.6 1];

for jj=1:10000;jj
    clear numG numH den b U
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%% GENERATING THE MODEL, THE TRAINING AND THE TEST SET %%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    [y,U,f,yy,UU,accband(jj),accSNR(jj),md]=creadata(mPEM,SNR,gen,Pbound,N,nf,inp,z);
    f=f(1:nf);accf(jj,:)=f;accdat(:,:,jj)=[y U];accmod{1,jj}=md;
end